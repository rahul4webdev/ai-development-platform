# CyberPanel/OpenLiteSpeed vhostconf for Next.js SSR Application
# Generated by AI Development Platform
#
# HOW TO USE:
# 1. Go to CyberPanel > Websites > {{WEB_DOMAIN}} > vHost Conf
# 2. Paste this configuration
# 3. Restart OpenLiteSpeed
#
# IMPORTANT: The Next.js app must be running on 127.0.0.1:3000
# Use PM2 or systemd to keep it running: pm2 start npm --name "{{PROJECT_SLUG}}" -- start

# External processor for Next.js SSR
extprocessor {{PROJECT_SLUG}}_proxy {
  type                    proxy
  address                 http://127.0.0.1:3000
  maxConns                100
  pcKeepAliveTimeout      60
  initTimeout             60
  retryTimeout            0
  respBuffer              0
}

# Proxy all requests to Next.js
context / {
  type                    proxy
  handler                 {{PROJECT_SLUG}}_proxy
  addDefaultCharset       off

  # CRITICAL: Forward X-Forwarded-Proto for Next.js HTTPS detection
  requestHeaders          X-Forwarded-Proto https
}
