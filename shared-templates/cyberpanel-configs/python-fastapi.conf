# CyberPanel/OpenLiteSpeed vhostconf for Python FastAPI Backend
# Generated by AI Development Platform
#
# HOW TO USE:
# 1. Go to CyberPanel > Websites > {{API_DOMAIN}} > vHost Conf
# 2. Paste this configuration
# 3. Restart OpenLiteSpeed
#
# IMPORTANT: The FastAPI app must be running on 127.0.0.1:8000
# Use systemd service or supervisor to keep it running

# External processor for FastAPI backend
extprocessor {{PROJECT_SLUG}}_proxy {
  type                    proxy
  address                 http://127.0.0.1:8000
  maxConns                100
  pcKeepAliveTimeout      60
  initTimeout             60
  retryTimeout            0
  respBuffer              0
}

# Proxy all requests to FastAPI
context / {
  type                    proxy
  handler                 {{PROJECT_SLUG}}_proxy
  addDefaultCharset       off

  # CORS headers for frontend communication
  extraHeaders            <<<END_extraHeaders
Access-Control-Allow-Origin https://{{WEB_DOMAIN}}
Access-Control-Allow-Methods GET, POST, PUT, PATCH, DELETE, OPTIONS
Access-Control-Allow-Headers Content-Type, Authorization, X-Requested-With, Accept, Origin
Access-Control-Allow-Credentials true
Access-Control-Max-Age 86400
  END_extraHeaders
}

# Static files (if needed)
# Uncomment if your FastAPI app serves static files
# context /static/ {
#   location /home/{{API_DOMAIN}}/public_html/staticfiles/
#   allowBrowse 1
#   addDefaultCharset off
# }
